2025-07-10 17:28:36,660 - INFO - Ingesting begin_inventory.csv into the database
2025-07-10 17:28:41,025 - INFO - Ingesting end_inventory.csv into the database
2025-07-10 17:28:56,599 - INFO - Ingesting purchases.csv into the database
2025-07-10 17:30:20,932 - INFO - Ingesting purchase_prices.csv into the database
2025-07-10 17:31:01,446 - INFO - Ingesting sales.csv into the database
2025-07-10 17:39:24,804 - INFO - Ingesting vendor_invoice.csv into the database
2025-07-10 17:39:25,023 - INFO - --------------Ingestion Complete------------
2025-07-10 17:39:25,023 - INFO - Total Time taken: 10.82 minutes
2025-07-10 17:39:25,882 - INFO - Ingesting begin_inventory.csv into the database
2025-07-10 17:39:30,677 - INFO - Ingesting end_inventory.csv into the database
2025-07-10 17:39:46,949 - INFO - Ingesting purchases.csv into the database
2025-07-10 17:41:18,244 - INFO - Ingesting purchase_prices.csv into the database
2025-07-10 17:42:01,846 - INFO - Ingesting sales.csv into the database
2025-07-10 17:50:32,685 - INFO - Ingesting vendor_invoice.csv into the database
2025-07-10 17:50:32,944 - INFO - --------------Ingestion Complete------------
2025-07-10 17:50:32,944 - INFO - Total Time taken: 11.13 minutes
2025-07-18 14:05:15,903 - INFO - Creating Vendor Summary Table...
2025-07-18 14:05:15,906 - ERROR - Error while creating vendor summary: Execution failed on sql '
    WITH FreightSummary AS (
        SELECT
            VendorNumber,
            SUM(Freight) AS Freight_Cost
        FROM vendor_invoice
        GROUP BY VendorNumber
    ),    

    PurchaseSummary AS (
        SELECT
            p.VendorNumber,
            p.VendorName,
            p.Brand,
            p.Description,
            p.PurchasePrice,
            pp.Price AS Actual_Price,
            pp.Volume,
            SUM(p.Quantity) AS TotalPurchaseQuantity,
            SUM(p.Dollars) AS TotalPurchaseDollars
        FROM purchases p
        JOIN purchase_prices pp
            ON p.Brand = pp.Brand
        WHERE p.PurchasePrice > 0
        GROUP BY p.VendorNumber, p.VendorName, p.Brand, p.Description, p.PurchasePrice, pp.Price, pp.Volume
    ),

    SalesSummary AS (
        SELECT
            VendorNo,
            Brand,
            SUM(SalesQuantity) AS TotalSalesQuantity,
            SUM(SalesDollars) AS TotalSalesDollars,
            SUM(Sales_Price) AS TotalSalesPrice,
            SUM(ExciseTax) AS TotalExciseTax
        FROM sales
        GROUP BY VendorNo, Brand
    )

    SELECT
        ps.VendorNumber,
        ps.VendorName,
        ps.Brand,
        ps.Description,
        ps.PurchasePrice,
        ps.Actual_Price,
        ps.Volume,
        ps.TotalPurchaseQuantity,
        ps.TotalPurchaseDollars,
        ss.TotalSalesQuantity,
        ss.TotalSalesDollars,
        ss.TotalSalesPrice,
        ss.TotalExciseTax,
        fs.Freight_Cost
    FROM PurchaseSummary ps
    LEFT JOIN SalesSummary ss
        ON ps.VendorNumber = ss.VendorNo
        AND ps.Brand = ss.Brand
    LEFT JOIN FreightSummary fs
        ON ps.VendorNumber = fs.VendorNumber
    ORDER BY ps.TotalPurchaseDollars DESC;
    ': no such column: Sales_Price
2025-07-18 14:06:40,782 - INFO - Creating Vendor Summary Table...
2025-07-18 14:08:05,969 - INFO - Vendor summary successfully created.
2025-07-18 14:08:05,981 - INFO - 
   VendorNumber                   VendorName  Brand              Description  \
0          1128  BROWN-FORMAN CORP             1233  Jack Daniels No 7 Black   
1          4425        MARTIGNETTI COMPANIES   3405    Tito's Handmade Vodka   
2         17035  PERNOD RICARD USA             8068         Absolut 80 Proof   
3          3960  DIAGEO NORTH AMERICA INC      4261   Capt Morgan Spiced Rum   
4          3960  DIAGEO NORTH AMERICA INC      3545          Ketel One Vodka   

   PurchasePrice  Actual_Price Volume  TotalPurchaseQuantity  \
0          26.27         36.99   1750                 145080   
1          23.19         28.99   1750                 164038   
2          18.24         24.99   1750                 187407   
3          16.17         22.99   1750                 201682   
4          21.89         29.99   1750                 138109   

   TotalPurchaseDollars  TotalSalesQuantity  TotalSalesDollars  \
0            3811251.60            142049.0         5101919.51   
1            3804041.22            160247.0         4819073.49   
2            3418303.68            187140.0         4538120.60   
3            3261197.94            200412.0         4475972.88   
4            3023206.01            135838.0         4223107.62   

   TotalSalesPrice  TotalExciseTax  Freight_Cost  
0        672819.31       260999.20      68601.68  
1        561512.37       294438.66     144929.24  
2        461140.15       343854.07     123780.22  
3        420050.01       368242.80     257032.07  
4        545778.28       249587.83     257032.07  
2025-07-18 14:08:05,981 - INFO - Cleaning Data...
2025-07-18 14:08:06,019 - INFO - 
   VendorNumber                VendorName  Brand              Description  \
0          1128         BROWN-FORMAN CORP   1233  Jack Daniels No 7 Black   
1          4425     MARTIGNETTI COMPANIES   3405    Tito's Handmade Vodka   
2         17035         PERNOD RICARD USA   8068         Absolut 80 Proof   
3          3960  DIAGEO NORTH AMERICA INC   4261   Capt Morgan Spiced Rum   
4          3960  DIAGEO NORTH AMERICA INC   3545          Ketel One Vodka   

   PurchasePrice  Actual_Price  Volume  TotalPurchaseQuantity  \
0          26.27         36.99  1750.0                 145080   
1          23.19         28.99  1750.0                 164038   
2          18.24         24.99  1750.0                 187407   
3          16.17         22.99  1750.0                 201682   
4          21.89         29.99  1750.0                 138109   

   TotalPurchaseDollars  TotalSalesQuantity  TotalSalesDollars  \
0            3811251.60            142049.0         5101919.51   
1            3804041.22            160247.0         4819073.49   
2            3418303.68            187140.0         4538120.60   
3            3261197.94            200412.0         4475972.88   
4            3023206.01            135838.0         4223107.62   

   TotalSalesPrice  TotalExciseTax  Freight_Cost  Gross_Profit  ProfitMargin  \
0        672819.31       260999.20      68601.68    1290667.91     25.297693   
1        561512.37       294438.66     144929.24    1015032.27     21.062810   
2        461140.15       343854.07     123780.22    1119816.92     24.675786   
3        420050.01       368242.80     257032.07    1214774.94     27.139908   
4        545778.28       249587.83     257032.07    1199901.61     28.412764   

   StockTurnover  SalesToPurchaseRatio  
0       0.979108              1.338647  
1       0.976890              1.266830  
2       0.998575              1.327594  
3       0.993703              1.372493  
4       0.983556              1.396897  
2025-07-18 14:08:06,020 - INFO - Ingesting data...
2025-07-18 14:08:06,139 - INFO - Completed.
2025-07-18 14:08:06,158 - INFO - Creating Vendor Summary Table...
2025-07-18 14:09:33,415 - INFO - Vendor summary successfully created.
2025-07-18 14:09:33,429 - INFO - 
   VendorNumber                   VendorName  Brand              Description  \
0          1128  BROWN-FORMAN CORP             1233  Jack Daniels No 7 Black   
1          4425        MARTIGNETTI COMPANIES   3405    Tito's Handmade Vodka   
2         17035  PERNOD RICARD USA             8068         Absolut 80 Proof   
3          3960  DIAGEO NORTH AMERICA INC      4261   Capt Morgan Spiced Rum   
4          3960  DIAGEO NORTH AMERICA INC      3545          Ketel One Vodka   

   PurchasePrice  Actual_Price Volume  TotalPurchaseQuantity  \
0          26.27         36.99   1750                 145080   
1          23.19         28.99   1750                 164038   
2          18.24         24.99   1750                 187407   
3          16.17         22.99   1750                 201682   
4          21.89         29.99   1750                 138109   

   TotalPurchaseDollars  TotalSalesQuantity  TotalSalesDollars  \
0            3811251.60            142049.0         5101919.51   
1            3804041.22            160247.0         4819073.49   
2            3418303.68            187140.0         4538120.60   
3            3261197.94            200412.0         4475972.88   
4            3023206.01            135838.0         4223107.62   

   TotalSalesPrice  TotalExciseTax  Freight_Cost  
0        672819.31       260999.20      68601.68  
1        561512.37       294438.66     144929.24  
2        461140.15       343854.07     123780.22  
3        420050.01       368242.80     257032.07  
4        545778.28       249587.83     257032.07  
2025-07-18 14:09:33,430 - INFO - Cleaning Data...
2025-07-18 14:09:33,468 - INFO - 
   VendorNumber                VendorName  Brand              Description  \
0          1128         BROWN-FORMAN CORP   1233  Jack Daniels No 7 Black   
1          4425     MARTIGNETTI COMPANIES   3405    Tito's Handmade Vodka   
2         17035         PERNOD RICARD USA   8068         Absolut 80 Proof   
3          3960  DIAGEO NORTH AMERICA INC   4261   Capt Morgan Spiced Rum   
4          3960  DIAGEO NORTH AMERICA INC   3545          Ketel One Vodka   

   PurchasePrice  Actual_Price  Volume  TotalPurchaseQuantity  \
0          26.27         36.99  1750.0                 145080   
1          23.19         28.99  1750.0                 164038   
2          18.24         24.99  1750.0                 187407   
3          16.17         22.99  1750.0                 201682   
4          21.89         29.99  1750.0                 138109   

   TotalPurchaseDollars  TotalSalesQuantity  TotalSalesDollars  \
0            3811251.60            142049.0         5101919.51   
1            3804041.22            160247.0         4819073.49   
2            3418303.68            187140.0         4538120.60   
3            3261197.94            200412.0         4475972.88   
4            3023206.01            135838.0         4223107.62   

   TotalSalesPrice  TotalExciseTax  Freight_Cost  Gross_Profit  ProfitMargin  \
0        672819.31       260999.20      68601.68    1290667.91     25.297693   
1        561512.37       294438.66     144929.24    1015032.27     21.062810   
2        461140.15       343854.07     123780.22    1119816.92     24.675786   
3        420050.01       368242.80     257032.07    1214774.94     27.139908   
4        545778.28       249587.83     257032.07    1199901.61     28.412764   

   StockTurnover  SalesToPurchaseRatio  
0       0.979108              1.338647  
1       0.976890              1.266830  
2       0.998575              1.327594  
3       0.993703              1.372493  
4       0.983556              1.396897  
2025-07-18 14:09:33,468 - INFO - Ingesting data...
2025-07-18 14:09:33,651 - INFO - Completed.
2025-07-18 14:09:58,258 - INFO - Creating Vendor Summary Table...
2025-07-18 14:11:23,222 - INFO - Vendor summary successfully created.
2025-07-18 14:11:23,231 - INFO - 
   VendorNumber                   VendorName  Brand              Description  \
0          1128  BROWN-FORMAN CORP             1233  Jack Daniels No 7 Black   
1          4425        MARTIGNETTI COMPANIES   3405    Tito's Handmade Vodka   
2         17035  PERNOD RICARD USA             8068         Absolut 80 Proof   
3          3960  DIAGEO NORTH AMERICA INC      4261   Capt Morgan Spiced Rum   
4          3960  DIAGEO NORTH AMERICA INC      3545          Ketel One Vodka   

   PurchasePrice  Actual_Price Volume  TotalPurchaseQuantity  \
0          26.27         36.99   1750                 145080   
1          23.19         28.99   1750                 164038   
2          18.24         24.99   1750                 187407   
3          16.17         22.99   1750                 201682   
4          21.89         29.99   1750                 138109   

   TotalPurchaseDollars  TotalSalesQuantity  TotalSalesDollars  \
0            3811251.60            142049.0         5101919.51   
1            3804041.22            160247.0         4819073.49   
2            3418303.68            187140.0         4538120.60   
3            3261197.94            200412.0         4475972.88   
4            3023206.01            135838.0         4223107.62   

   TotalSalesPrice  TotalExciseTax  Freight_Cost  
0        672819.31       260999.20      68601.68  
1        561512.37       294438.66     144929.24  
2        461140.15       343854.07     123780.22  
3        420050.01       368242.80     257032.07  
4        545778.28       249587.83     257032.07  
2025-07-18 14:11:23,231 - INFO - Cleaning Data...
2025-07-18 14:11:23,258 - INFO - 
   VendorNumber                VendorName  Brand              Description  \
0          1128         BROWN-FORMAN CORP   1233  Jack Daniels No 7 Black   
1          4425     MARTIGNETTI COMPANIES   3405    Tito's Handmade Vodka   
2         17035         PERNOD RICARD USA   8068         Absolut 80 Proof   
3          3960  DIAGEO NORTH AMERICA INC   4261   Capt Morgan Spiced Rum   
4          3960  DIAGEO NORTH AMERICA INC   3545          Ketel One Vodka   

   PurchasePrice  Actual_Price  Volume  TotalPurchaseQuantity  \
0          26.27         36.99  1750.0                 145080   
1          23.19         28.99  1750.0                 164038   
2          18.24         24.99  1750.0                 187407   
3          16.17         22.99  1750.0                 201682   
4          21.89         29.99  1750.0                 138109   

   TotalPurchaseDollars  TotalSalesQuantity  TotalSalesDollars  \
0            3811251.60            142049.0         5101919.51   
1            3804041.22            160247.0         4819073.49   
2            3418303.68            187140.0         4538120.60   
3            3261197.94            200412.0         4475972.88   
4            3023206.01            135838.0         4223107.62   

   TotalSalesPrice  TotalExciseTax  Freight_Cost  Gross_Profit  ProfitMargin  \
0        672819.31       260999.20      68601.68    1290667.91     25.297693   
1        561512.37       294438.66     144929.24    1015032.27     21.062810   
2        461140.15       343854.07     123780.22    1119816.92     24.675786   
3        420050.01       368242.80     257032.07    1214774.94     27.139908   
4        545778.28       249587.83     257032.07    1199901.61     28.412764   

   StockTurnover  SalesToPurchaseRatio  
0       0.979108              1.338647  
1       0.976890              1.266830  
2       0.998575              1.327594  
3       0.993703              1.372493  
4       0.983556              1.396897  
2025-07-18 14:11:23,260 - INFO - Ingesting data...
2025-07-18 14:11:23,370 - INFO - Completed.
